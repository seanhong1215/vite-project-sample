import{d as V,e as C,f as k}from"./api-ca49048a.js";import{_ as I,c as r,b as n,a as e,F as g,g as S,e as i,t as c,w,r as _,o as d,d as p,f as b,v,i as f}from"./index-b1306a14.js";const F={name:"Cart",data(){return{loadingStatus:{loadingItem:""},isLoading:!1,cart:{},form:{user:{name:"",email:"",tel:"",address:""},message:""},coupon_code:""}},methods:{getCart(){V().then(a=>{this.cart=a.data.data,console.log(this.cart)}).catch(a=>{alert(a.response.data.message)})},removeCartItem(a){this.loadingStatus.loadingItem=a,C(a).then(t=>{alert(t.data.message),this.loadingStatus.loadingItem="",this.getCart()}).catch(t=>{alert(t.response.data.message)})},createOrder(){const a=this.form;k({data:a}).then(t=>{alert(t.data.message),this.$refs.form.resetForm(),this.getCart()}).catch(t=>{alert(t.response.data.message)})}},mounted(){this.getCart()}},U=e("h1",null,"購物車頁面",-1),q={class:"container"},B={class:"row justify-content-center"},L={class:"col-md-6"},N={class:"table align-middle"},E=e("thead",null,[e("tr",null,[e("th"),e("th",null,"品名"),e("th",{style:{width:"150px"}},"數量/單位"),e("th",null,"單價")])],-1),O=["onClick","disabled"],j={key:0,class:"fas fa-spinner fa-pulse"},D={key:0,class:"text-success"},T={class:"input-group input-group-sm"},z={class:"input-group mb-3"},G=["onUpdate:modelValue","onBlur","disabled"],M={class:"input-group-text",id:"basic-addon2"},R={class:"text-end"},A={key:0,class:"text-success"},H=e("td",{colspan:"3",class:"text-end"},"總計",-1),J={class:"text-end"},K={key:0},P=e("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),Q={class:"text-end text-success"},W={class:"my-5 row justify-content-center"},X={class:"mb-3"},Y=e("label",{for:"email",class:"form-label"},"Email",-1),Z={class:"mb-3"},$=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),ee={class:"mb-3"},se=e("label",{for:"tel",class:"form-label"},"收件人電話",-1),te={class:"mb-3"},oe=e("label",{for:"address",class:"form-label"},"收件人地址",-1),le={class:"mb-3"},ae=e("label",{for:"message",class:"form-label"},"留言",-1),ne=e("div",{class:"text-end"},[e("button",{type:"submit",class:"btn btn-danger"},"送出訂單")],-1);function re(a,t,de,ie,s,h){const x=_("Loading"),m=_("Field"),u=_("error-message"),y=_("Form");return d(),r(g,null,[U,n(x,{active:s.isLoading},null,8,["active"]),e("div",q,[e("div",B,[e("div",L,[e("table",N,[E,e("tbody",null,[s.cart.carts?(d(!0),r(g,{key:0},S(s.cart.carts,o=>(d(),r("tr",{key:o.id},[e("td",null,[e("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:l=>h.removeCartItem(o.id),disabled:s.loadingStatus.loadingItem===o.id},[s.loadingStatus.loadingItem===o.id?(d(),r("i",j)):i("",!0),p(" x ")],8,O)]),e("td",null,[p(c(o.product.title)+" ",1),o.coupon?(d(),r("div",D," 已套用優惠券 ")):i("",!0)]),e("td",null,[e("div",T,[e("div",z,[b(e("input",{"onUpdate:modelValue":l=>o.qty=l,onBlur:l=>a.updateCart(o),disabled:s.loadingStatus.loadingItem===o.id,min:"1",type:"number",class:"form-control"},null,40,G),[[v,o.qty,void 0,{number:!0}]]),e("span",M,c(o.product.unit),1)])])]),e("td",R,[s.cart.final_total!==s.cart.total?(d(),r("small",A,"折扣價：")):i("",!0),p(" "+c(o.final_total),1)])]))),128)):i("",!0)]),e("tfoot",null,[e("tr",null,[H,e("td",J,c(s.cart.total),1)]),s.cart.final_total!==s.cart.total?(d(),r("tr",K,[P,e("td",Q,c(s.cart.final_total),1)])):i("",!0)])])])]),e("div",W,[n(y,{ref:"form",class:"col-md-6",onSubmit:h.createOrder},{default:w(({errors:o})=>[e("div",X,[Y,n(m,{id:"email",name:"email",type:"email",class:f(["form-control",{"is-invalid":o.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:s.form.user.email,"onUpdate:modelValue":t[0]||(t[0]=l=>s.form.user.email=l)},null,8,["class","modelValue"]),n(u,{name:"email",class:"invalid-feedback"})]),e("div",Z,[$,n(m,{id:"name",name:"姓名",type:"text",class:f(["form-control",{"is-invalid":o.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:s.form.user.name,"onUpdate:modelValue":t[1]||(t[1]=l=>s.form.user.name=l)},null,8,["class","modelValue"]),n(u,{name:"姓名",class:"invalid-feedback"})]),e("div",ee,[se,n(m,{id:"tel",name:"電話",type:"text",class:f(["form-control",{"is-invalid":o.電話}]),placeholder:"請輸入電話",rules:"required|min:8|max:10",modelValue:s.form.user.tel,"onUpdate:modelValue":t[2]||(t[2]=l=>s.form.user.tel=l)},null,8,["class","modelValue"]),n(u,{name:"電話",class:"invalid-feedback"})]),e("div",te,[oe,n(m,{id:"address",name:"地址",type:"text",class:f(["form-control",{"is-invalid":o.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:s.form.user.address,"onUpdate:modelValue":t[3]||(t[3]=l=>s.form.user.address=l)},null,8,["class","modelValue"]),n(u,{name:"地址",class:"invalid-feedback"})]),e("div",le,[ae,b(e("textarea",{name:"",id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":t[4]||(t[4]=l=>s.form.message=l)},null,512),[[v,s.form.message]])]),ne]),_:1},8,["onSubmit"])])])],64)}const ue=I(F,[["render",re]]);export{ue as default};
